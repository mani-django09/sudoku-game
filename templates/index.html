<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sudoku Game</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="game-container">
        <header class="game-header">
            <div class="header-left">
                <h1>Sudoku</h1>
                <div class="difficulty-selector">
                    <button class="mode-btn active" id="new-game" data-difficulty="easy">Easy</button>
                    <button class="mode-btn" data-difficulty="medium">Medium</button>
                    <button class="mode-btn" data-difficulty="hard">Hard</button>
                </div>
            </div>
            <div class="header-right">
                <div class="game-stats">
                    <div class="mistakes">Mistakes: <span id="mistakes">0/3</span></div>
                    <div class="score">Score: <span id="score">0</span></div>
                </div>
                <button id="pause" class="icon-btn">
                    <i data-feather="pause"></i>
                </button>
                <div id="timer" class="game-timer">00:00:00</div>
            </div>
        </header>

        <div class="game-board-container">
            <div id="sudoku-board"></div>
            
            <div class="game-controls">
                <div class="control-buttons">
                    <button class="control-btn" id="undo">
                        <i data-feather="rotate-ccw"></i>
                        <span>Undo</span>
                    </button>
                    <button class="control-btn" id="erase">
                        <i data-feather="delete"></i>
                        <span>Erase</span>
                    </button>
                    <button class="control-btn" id="pencil">
                        <i data-feather="edit-2"></i>
                        <span>Notes</span>
                        <div class="state-indicator">OFF</div>
                    </button>
                    <button class="control-btn" id="hint">
                        <i data-feather="help-circle"></i>
                        <span>Hint</span>
                        <div class="hint-count">3</div>
                    </button>
                </div>
                
                <div id="numpad" class="numpad-grid"></div>

                <button id="new-game-btn" class="new-game-btn">
                    New Game
                </button>
            </div>
        </div>

        <section class="how-to-play">
            <h2>How to play beginner Sudoku puzzles?</h2>
            <p>The goal of Sudoku is to fill the cells with numbers from 1 to 9. The numbers are placed in 9 squares, 3x3 each, thus, in each row, in each column and in each small square there are 9 cells. The same digit can be used only once in each separate column, each line and in each small square. The level of difficulty depends on how many digits are already indicated in the cells. If you open plenty of numbers - then you have very easy Sudoku.</p>
            
            <h2>The advantages of easy web Sudoku</h2>
            <p>The advantage of online games on Sudoku.com is that the game is always available and you can use various useful features. You can receive hints, correct or delete the entered data, take notes and stop the time needed to solve the puzzle. If you need to interrupt the game, you can always press a pause button.</p>
        </section>

        <div class="mobile-download">
            <h3>Play Sudoku on Mobile</h3>
            <div class="app-buttons">
                <a href="#" class="app-button">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/3/3c/Download_on_the_App_Store_Badge.svg" alt="Download on App Store">
                </a>
                <a href="#" class="app-button">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg" alt="Get it on Google Play">
                </a>
            </div>
            <div class="qr-code">
                <img src="data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='100' height='100' fill='%23ffffff'/%3E%3C/svg%3E" alt="QR Code">
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-section">
                <p class="copyright">&copy; <span id="current-year"></span> Sudoku Game. All rights reserved.</p>
                <span class="version">v1.0.0</span>
            </div>
            <div class="footer-section">
                <nav class="footer-links">
                    <a href="#">About</a>
                    <a href="#">Terms</a>
                    <a href="#">Privacy</a>
                </nav>
            </div>
            <div class="footer-section">
                <div class="social-links">
                    <a href="#" aria-label="Facebook"><i data-feather="facebook"></i></a>
                    <a href="#" aria-label="Twitter"><i data-feather="twitter"></i></a>
                    <a href="#" aria-label="Instagram"><i data-feather="instagram"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts loaded at the bottom for better performance -->
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="{{ url_for('static', filename='js/timer.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sudoku.js') }}"></script>
    <script src="{{ url_for('static', filename='js/game.js') }}"></script>
    <script>
        // Initialize everything after DOM is fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM fully loaded, initializing game...');
            
            // Initialize Feather icons
            try {
                feather.replace();
                console.log('Feather icons initialized successfully');
                // Set current year in footer
                document.getElementById('current-year').textContent = new Date().getFullYear();
            } catch (error) {
                console.error('Failed to initialize Feather icons:', error);
            }
            
            // Initialize game after ensuring all elements are loaded
            try {
                // Verify required elements exist before initialization
                const requiredElements = [
                    'sudoku-board',
                    'numpad',
                    'timer',
                    'pause'
                ];
                
                const missingElements = requiredElements.filter(id => !document.getElementById(id));
                if (missingElements.length > 0) {
                    throw new Error(`Missing required elements: ${missingElements.join(', ')}`);
                }
                
                window.game = new SudokuGame();
                console.log('Game initialized successfully');
            } catch (error) {
                console.error('Failed to initialize game:', error);
                // Show user-friendly error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.textContent = 'Failed to load the game. Please refresh the page.';
                const container = document.querySelector('.game-container');
                if (container) {
                    container.prepend(errorDiv);
                }
            }
        });
    </script>
</body>
</html>
